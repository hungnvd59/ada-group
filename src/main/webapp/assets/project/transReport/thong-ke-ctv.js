app.controller('partnerCtrl', ['$scope', '$http', '$timeout', '$q', function ($scope, $http, $timeout, $q) {    $scope.page = page;    $scope.listData = {items: "", rowCount: 0, numberPerPage: 15, pageNumber: 1, pageList: [], pageCount: 0};    $scope.firstSearch = true;    $scope.fromDate = moment(new Date(moment().startOf('month'))).format('DD/MM/YYYY');    $scope.toDate = moment(new Date()).format('DD/MM/YYYY');    $scope.logs = [];    $scope.pageNumber = 1;    $("#fromDate").datetimepicker({        locale: 'vi-VN',        format: 'DD-MM-YYYY',        icons: {            time: "fa fa-clock-o",            date: "fa fa-calendar",            up: "fa fa-chevron-up",            down: "fa fa-chevron-down",            previous: 'fa fa-chevron-left',            next: 'fa fa-chevron-right',            today: 'fa fa-screenshot',            clear: 'fa fa-trash',            close: 'fa fa-remove'        }    }).on('dp.change', function (e) {        if (e != null) {            $scope.fromDate = $(this).val();        }    })    $("#toDate").datetimepicker({        locale: 'vi-VN',        format: 'DD-MM-YYYY',        icons: {            time: "fa fa-clock-o",            date: "fa fa-calendar",            up: "fa fa-chevron-up",            down: "fa fa-chevron-down",            previous: 'fa fa-chevron-left',            next: 'fa fa-chevron-right',            today: 'fa fa-screenshot',            clear: 'fa fa-trash',            close: 'fa fa-remove'        }    }).on('dp.change', function (e) {        if (e != null) {            $scope.toDate = $(this).val();        }    })    $(document).ready(function () {    });    $scope.totalByDay = 0;    $scope.total = 0;    $scope.search = function (pageNumber) {        if(!$scope.firstSearch) {//xử lý thêm            $scope.fromDate = $("#fromDate").val();            $scope.toDate = $("#toDate").val();        }        $scope.totalByDay = 0;        $scope.total = 0;        $scope.listData.pageNumber = pageNumber;        $http.get(preUrl + "/transReport/searchPartner", {            params: {                p: $scope.listData.pageNumber,                numberPerPage: $scope.listData.numberPerPage,                fromDate: $scope.fromDate,                toDate: $scope.toDate            }        })            .then(function (response) {                if (response != null && response != 'undefined' && response.status == 200) {                    $scope.listData = response.data;                    $scope.listData.pageCount = getPageCount($scope.listData);                    $scope.listData.pageList = getPageList($scope.listData);                    $scope.listData.items.forEach((item) => {                        $scope.totalByDay = Number($scope.totalByDay) + Number(item.partnerResDay);                    });                }            });        $http.get(preUrl + "/transReport/getTotalPartner", {            params: {                // toDate: $scope.toDate            }        })            .then(function (response) {                if (response != null && response != 'undefined' && response.status == 200) {                    $scope.total = response.data.rowCount;                }            });        $scope.firstSearch = false;    }    $scope.clear = function () {        $scope.fromDate = moment(new Date(moment().startOf('month'))).format('DD/MM/YYYY');        $scope.toDate = moment(new Date()).format('DD/MM/YYYY');    };    $scope.setNumberPerPage = function (numberPerPage) {        $scope.listData.pageNumber = 1;        $scope.listData.numberPerPage = numberPerPage;        $scope.search(1);    }    $scope.ChangeFormateDate = function (oldDate)    {//convert date yyyy-mm-dd to dd/mm/yyyy        return oldDate.toString().split("-").reverse().join("/");    }    // -------------------------Init----------------------------    $scope.search(1);}]);